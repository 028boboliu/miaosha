### mysql数据库设计与优化与架构 模拟场景（京东商城）

    任何优化多需要场景，本次所有的场景为京东商城的数据库设计模拟！
    有问题或者宝贵意见联系我的QQ,非常希望你的加入！
    
##简介：

     设计：
     1.数据库开发规范的制定
     2.数据库结构与设计
     3.mysql执行计划的分析
     4.mysql数据库的备份和恢复
     5.mysql高性能高可用架构变迁
     
 **场景说明**


        用户登录->选购商品->加购物车->检查库存->提交订单->货到付款-- Y -- 发货
                                                           |N--订单付款
                                                           
        用户模块  -- 完成用户注册和登录验证
        商品模块  -- 前后台商品管理和游览
        订单模块  -- 订单和购物车的生成和管理
        仓配模块  -- 仓库库存和物流的管理

**数据库设计规范**
    
    
       逻辑设计 + 物理设计
    
        1.数据库命名规范
        2.数据库基本设计规范
        3.数据库索引设计规范
        4.数据库字段设计规范
        5.数据库的sql开发规范
        数据库操作行为规范（运维标准）
     
     数据库设计规范 
     
     1.所有的数据库对象名称必须使用小写字母并用下划线分割（mysql数据库大小写敏感） 
     例如: 不同的数据库名  DbName dbname 不同的表名 Table table taBLe
     
     2.所有数据库对象名称禁止使用mysql保留关键字
     例如 ：select id , username , from ,age from table_user 会造成mysql 歧义
     
     3.数据库对象的命名要做到见名识义，并且最好不要超过32个字符
     例如：秒杀用户表  miaosha_userdb good!!
          用户账号表  user_account good!!
          
     4.所有的临时表必须义tmp为前缀并且已日期为后缀，备份库备份表必须义bak为前缀并且已日期为后缀，大的可以到处sql
     
     5.所有的数据存储的列名和列类型必须一致
     custom_inf                     order_master 
     customer_id  int unsigned      customer_id  int unsigned  
     必须一致否则会影响性能，一般这种列都是作为表的关联列，如果两个字段的数据类型不同，数据库则会进行隐式的数据类型
     转换降低性能，造成列上的索引失效！！
     
     存储规范
     
     1.所有的表必须使用Innodb存储引擎 支持事物行级锁，更好的恢复性，并发性能更好
     2.大部分数据库表字符集要统一   （大部分使用UTF-8） 编码乱码 
     3.所有的表和字段都要添加注释 数据字典的维护
     4.尽量控制单表的数据量大小，建议控制在500万以内 当然500万并不是mysql的限制
       过大可以通过历史数据归档，分库分表的手段来控制数据量的大小（订单表一类的比较重要）
     5.尽量做到冷热数据分离，减少表的宽度  列最大4096列 
       减少磁盘io,保证热数据的内存缓存命中率，控制列数量也可以更加有效的利用缓存，避免读入无用的冷数据
       经常使用的列放在一个表中
     6.禁止在表中建立预留字段
       预留字段命名很难做到见识义，无法选择合适的类型，对预留字段修改会对表进行锁定
       
     行为规范
     
     1.禁止存储图片，文件等二进制文件，造成大量的io操作 （存在相应的文件服务器上）
     2.禁止再线上进行数据库的压力测试
     3.禁止从开发环境测试环境直连生产环境
     
     索引设计规范（不要滥用索引）
     
     1.建议单表索引数量不超过5个 索引并不是越多越好过多索引降低效率，优化器过多索引选出最优解
     innodb 是按照那个索引的顺序来组织表的呢   主键
     不使用更新频繁的列作为主键，不使用多列主键
     不使用uuid,md5,hash 字符串列作为主键  不能保证顺序增长
     
     2.那些哪些列上建立索引？？？
       1.我们经常在select update delete语句的where从句的列建立索引
       2.包含在order by , group by , distinct 中的字段
       3.多表join的关联列
       
     3.如何选择索引的顺序？
     联合索引中  索引从左到右的顺序
     建立索引的目的 查询数据的时候可以根据索引来进行数据查找-- 从而减少磁盘的随机io , 增加查询的性能，所以
     如果我们的索引能够过滤出更少的数据那么我们从磁盘读入的数据则越少
     
       1.区分度最高的列放在联合索引的最左侧 区分度--数据唯一值的数量/总行数 区分度最大的就应该是主键了
       2.尽量字段长度小的列放在联合索引的最左侧 
       3.使用最频繁的列放在最左侧 
       4，尽量避免冗余和重复的索引   重复索引了： primary key(id) , index(id) , unique index(id)
          冗余： index(a,b,c) , index(a.b)
       5.对于频繁使用的查询先优先考虑覆盖索引（包含了所有的查询字段的索引）
       6.尽量使用外键 不建议使用外检约束，但是一定要在表与表之间的关联键上建立索引
     
     
     
     
      